# JVM内存模型以及各个分区知识

---

内存模型以及分区，需要详细到每个区放什么。

堆里面的分区：Eden，survival （from+ to），老年代，各自的特点。

GC 的两种判定方法

Minor GC 与 Full GC 分别在什么时候发生？

类加载的几个过程

JVM 内存分哪几个区，每个区的作用是什么

如和判断一个对象是否存活?(或者 GC 对象的判定方法）

java 中垃圾收集的方法有哪些?

什么是类加载器，类加载器有哪些?

类加载器双亲委派模型机制？

什么情况下会发生栈内存溢出？

怎么打破双亲委派模型？

强引用、软应用、弱引用、虚引用的区别？



## JVM的内存模型

JVM时Java Virtual Machine（Java虚拟机）的缩写。JVM是一个虚拟出来的计算机，有着自己的架构设计。

JVM的内存模型总体分为五个部分：堆、栈、方法区、程序计数器和本地方法栈。

<img src="https://s2.loli.net/2023/04/26/HRftqox3U2LKXb4.png" alt="image.png" style="zoom:80%;" />

## 各区域的作用

### 堆(Heap)

在Java中，堆被划分成两个不同的区域：新生代(Young)、老年代(Old)和永久代。

#### 新生代(Young)

新生代又可以分为：Eden、From Survivor、To Survivor。

<img src="https://s2.loli.net/2023/04/26/vPp4KEB7Hn8VIuW.png" alt="image.png" style="zoom:50%;" />

堆时Java虚拟机所管理的内存中最大的一块内存区域，也是被各个线程共享的内存区域，该区域存放对象实例以及数组。

新生代的区域配置一般是-Xms(最小值)和-Xmx(最大值)等进行参数设置，前者为启动的时候申请最小内存，默认为操作系统物理内存的1/64，后者为JVM可申请的最大内存，默认为物理内存的1/4。默认当空余堆内存小于40%时，JVM会增大堆内存到-Xmx指定的大小，如果需要进行验证则可以通过-XX:MinHeapFreeRation=来指定这个比例。

当空余堆内存大于70%时，JVM会减小堆内存的大小到-Xms指定的大小，可以通过-XX:MinHeapFreeRation=来指定这个比例，当然为了避免在运行时频繁调整Heap的大小，通常-Xms与-Xmx的值设为一样。`堆内存 = 新生代 + 老年代 + 持久代`。

